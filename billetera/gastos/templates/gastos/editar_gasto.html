{% extends "base.html" %}
{% load static %}
{% block title %}Editar Gasto - MoneyFlow Mirror{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <!-- Header Section -->
    <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">‚úèÔ∏è Editar Gasto</h1>
        <p class="text-gray-600">Actualiza los detalles de tu gasto de manera consciente</p>
    </div>

    <!-- Form Card -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
        <div class="bg-expense text-white p-6">
            <div class="flex items-center">
                <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center mr-4">
                    <span class="text-2xl">üí∏</span>
                </div>
                <div>
                    <h2 class="text-xl font-semibold">Modificar Gasto</h2>
                    <p class="text-expense-light opacity-90">Ajusta los detalles seg√∫n sea necesario</p>
                </div>
            </div>
        </div>

        <div class="p-6">
            <form method="post" class="space-y-6">
                {% csrf_token %}
                
                <!-- Descripci√≥n -->
                <div>
                    <label for="{{ form.descripcion.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        üìù {{ form.descripcion.label }}
                    </label>
                    <input type="text" 
                           name="{{ form.descripcion.name }}" 
                           id="{{ form.descripcion.id_for_label }}"
                           value="{{ form.descripcion.value|default:'' }}"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-expense focus:border-expense transition-colors duration-200 {% if form.descripcion.errors %}border-red-500{% endif %}"
                           placeholder="Describe tu gasto..."
                           required>
                    {% if form.descripcion.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.descripcion.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Categor√≠a -->
                <div>
                    <label for="{{ form.categoria.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        üìÅ {{ form.categoria.label }}
                    </label>
                    <select name="{{ form.categoria.name }}" 
                            id="{{ form.categoria.id_for_label }}"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-expense focus:border-expense transition-colors duration-200 {% if form.categoria.errors %}border-red-500{% endif %}"
                            required>
                        {% for choice in form.categoria.field.choices %}
                            <option value="{{ choice.0 }}" {% if form.categoria.value == choice.0 %}selected{% endif %}>
                                {{ choice.1 }}
                            </option>
                        {% endfor %}
                    </select>
                    {% if form.categoria.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.categoria.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Monto y Moneda -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="md:col-span-2">
                        <label for="{{ form.monto.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                            üí∞ {{ form.monto.label }}
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <span class="text-gray-500 text-lg font-semibold">$</span>
                            </div>
                            <input type="number" 
                                   step="0.01"
                                   name="{{ form.monto.name }}" 
                                   id="{{ form.monto.id_for_label }}"
                                   value="{{ form.monto.value|default:'' }}"
                                   class="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-expense focus:border-expense transition-colors duration-200 font-numbers {% if form.monto.errors %}border-red-500{% endif %}"
                                   placeholder="0.00"
                                   required>
                        </div>
                        {% if form.monto.errors %}
                            <p class="mt-1 text-sm text-red-600">{{ form.monto.errors.0 }}</p>
                        {% endif %}
                    </div>
                    <div>
                        <label for="{{ form.moneda.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                            üí± {{ form.moneda.label }}
                        </label>
                        <select name="{{ form.moneda.name }}" 
                                id="{{ form.moneda.id_for_label }}"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-expense focus:border-expense transition-colors duration-200 {% if form.moneda.errors %}border-red-500{% endif %}"
                                required>
                            {% for choice in form.moneda.field.choices %}
                                <option value="{{ choice.0 }}" {% if form.moneda.value == choice.0 %}selected{% endif %}>
                                    {{ choice.1 }}
                                </option>
                            {% endfor %}
                        </select>
                        {% if form.moneda.errors %}
                            <p class="mt-1 text-sm text-red-600">{{ form.moneda.errors.0 }}</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="flex space-x-4 pt-4">
                    <button type="submit" 
                            class="flex-1 bg-expense hover:bg-expense-dark text-white font-medium px-6 py-3 rounded-lg transition-colors duration-200 shadow-sm hover:shadow-md inline-flex items-center justify-center">
                        <span class="mr-2">üíæ</span>
                        Guardar Cambios
                    </button>
                    <a href="{% url 'gastos:lista_gastos' %}" 
                       class="bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium px-6 py-3 rounded-lg transition-colors duration-200 inline-flex items-center justify-center">
                        <span class="mr-2">‚Ü©Ô∏è</span>
                        Cancelar
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
// Auto-format amount input
document.addEventListener('DOMContentLoaded', function() {
    const amountInput = document.querySelector('input[type="number"]');
    if (amountInput) {
        amountInput.addEventListener('blur', function() {
            if (this.value && !isNaN(this.value)) {
                this.value = parseFloat(this.value).toFixed(2);
            }
        });
    }
});
</script>
{% endblock %}
